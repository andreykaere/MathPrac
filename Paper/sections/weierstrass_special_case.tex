\subsection*{Явное вычисление для кубики из нашей задачи}

%!TEX root = ../paper.tex

\noindent Приведём явные выкладки для кривой вида:
\[
F(x, y, z) = x^3 + y^3 + z^3 + (1 - N) (x^2 y + x^2 z + y^2 x + y^2 z + z^2 x + z^2 y) +
(3 - 2 N) x y z 
.\] 
В этом случае рациональная точка \(P = (1 : -1 : 0)\) является также точкой перегиба
(проверяется непосредственно подстановкой в Гессиан).

\begin{itemize}[leftmargin=0.6cm]
    \item Шаг 1. Переведём точку \(P = (1 : -1 : 0)\) в точку
    \((0 : 1 : 0)\) некоторым проективным преобразованием. Например,
    подойдёт такое:
    \[
    \lambda
    \begin{pmatrix}
        \widetilde{x} \\
        \widetilde{y} \\
        \widetilde{z} \\
    \end{pmatrix} 
    = 
    \begin{pmatrix}
        1 & 1 & 0 \\
        1 & 0 & 0 \\
        0 & 0 & 1 \\
    \end{pmatrix}
    \begin{pmatrix}
        x \\
        y \\
        z \\
    \end{pmatrix}
    \]
    или
    \[
    \begin{pmatrix}
        x \\
        y \\
        z \\
    \end{pmatrix} =
    \lambda
    \begin{pmatrix}
        0 & 1 & 0 \\
        1 & -1 & 0 \\
        0 & 0 & 1 \\
    \end{pmatrix}
    \begin{pmatrix}
        \widetilde{x} \\
        \widetilde{y} \\
        \widetilde{z} \\
    \end{pmatrix} 
    .\] 
    

    Тогда наше уравнение преобразуется в следующее:  
    \begin{align*}
        \widetilde{F}(\widetilde{x}, \widetilde{y}, \widetilde{z}) &= 
     \left(\widetilde{z}\right)^3
     -(N + 2) \left(\widetilde{x}\right)^2 \widetilde{y} + (1 - N)
     \left(\widetilde{x}\right)^2 \widetilde{z} + (N + 2) \,
     \widetilde{x} \left(\widetilde{y}\right)^2 \\ 
     &+ (1 - N) \, \widetilde{x} \left(\widetilde{z}\right)^2 + 
     \left(\widetilde{x}\right)^3 + \widetilde{x} \,
     \widetilde{y} \, \widetilde{z} -
     \left(\widetilde{y}\right)^2 \widetilde{z}
    .\end{align*}
    

    \item Шаг 2. Теперь мы хотим сделать преобразование,
    сохраняющее точку \(O = (0 : 1 : 0)\), так, чтобы
    прямая \(z = 0\) была касательной к кубике \(\widetilde{F}\) в точке
    \(O\), то есть сделать преобразование \((\widetilde{x} :
    \widetilde{y} : \widetilde{z}) \to (x' : y' : z')\), такое что
    для \(F'(x', y', z')\) будет выполнено: 
     \[
    \frac{\partial F'}{\partial x'} (O) = \frac{\partial F'}{\partial y'}
    (O) = 0, \quad \frac{\partial F'}{\partial z'} (O) \ne 0
    .\]
    Пусть имеет место соотношение
    \[
    \begin{pmatrix}
        \widetilde{x} \\
        \widetilde{y} \\
        \widetilde{z} \\
    \end{pmatrix} 
    = 
    \begin{pmatrix}
        c_{11} & c_{12} & c_{13} \\
        c_{21} & c_{22} & c_{23} \\
        c_{31} & c_{32} & c_{33} \\
    \end{pmatrix}
    \begin{pmatrix}
        x' \\
        y' \\
        z' \\
    \end{pmatrix}
    .\] 
    Так как точка \(O\) должна быть неподвижна, то:
    \[
    \begin{pmatrix}
        0 \\
        1 \\
        0 \\
    \end{pmatrix}
    = 
    \begin{pmatrix}
        c_{11} & c_{12} & c_{13} \\
        c_{21} & c_{22} & c_{23} \\
        c_{31} & c_{32} & c_{33} \\
    \end{pmatrix}
    \begin{pmatrix}
        0 \\
        1 \\
        0 \\
    \end{pmatrix}
    ,\] 
    откуда \(c_{12} = 0, c_{22} = 1, c_{32} = 0\). 
        
    Кроме того, поскольку \(F'(x', y', z') = \widetilde{F}(\widetilde{x}(x', y', z'),
    \widetilde{y}(x', y', z'), \widetilde{z}(x', y', z'))\), то мы имеем:
    %
    \begin{align*}
    \frac{\partial F'}{\partial x'} (O) &= \frac{\partial
    \widetilde{F}}{\partial \widetilde{x}} (\widetilde{x}(O),
    \widetilde{y}(O), \widetilde{z}(O))
    \frac{\partial \widetilde{x}}{\partial x'} (O) + \frac{\partial
    \widetilde{F}}{\partial \widetilde{y}} (\widetilde{x}(O),
    \widetilde{y}(O), \widetilde{z}(O))
    \frac{\partial \widetilde{y}}{\partial x'} (O) \\ 
    &+ \frac{\partial
    \widetilde{F}}{\partial \widetilde{z}} (\widetilde{x}(O),
    \widetilde{y}(O), \widetilde{z}(O))
    \frac{\partial \widetilde{z}}{\partial x'} (O) \\ &= 
    \frac{\partial \widetilde{F}}{\partial \widetilde{x}}(c_{12}, c_{22},
    c_{32}) c_{11} 
    + \frac{\partial \widetilde{F}}{\partial
    \widetilde{y}}(c_{12}, c_{22}, c_{32}) c_{21} + \frac{\partial
    \widetilde{F}}{\partial \widetilde{z}}(c_{12}, c_{22}, c_{32}) c_{31} \\
    &= 
    \frac{\partial \widetilde{F}}{\partial \widetilde{x}}(0, 1, 0) c_{11} 
    + \frac{\partial \widetilde{F}}{\partial
    \widetilde{y}}(0, 1, 0) c_{21} + \frac{\partial
    \widetilde{F}}{\partial \widetilde{z}}(0, 1, 0) c_{31} = (2 + N) c_{11}
    - c_{31}
    .\end{align*}
    Аналогично получаем:
    \begin{align*}
    \frac{\partial F'}{\partial y'} (O) &= \left( \frac{\partial
    \widetilde{F}}{\partial \widetilde{x}} 
    \frac{\partial \widetilde{x}}{\partial y'}  + \frac{\partial
    \widetilde{F}}{\partial \widetilde{y}} 
    \frac{\partial \widetilde{y}}{\partial y'}  + \frac{\partial
    \widetilde{F}}{\partial \widetilde{z}} 
    \frac{\partial \widetilde{z}}{\partial y'} \right) \! \! \Bigg|_{O}  = (2 + N) \frac{\partial \widetilde{x}}{\partial y'}(O) - \frac{\partial
    \widetilde{z}}{\partial y'} (O) = (2 + N) c_{12} - c_{32} \\
    \frac{\partial F'}{\partial z'} (O) &= \left( \frac{\partial
    \widetilde{F}}{\partial \widetilde{x}} 
    \frac{\partial \widetilde{x}}{\partial z'}  + \frac{\partial
    \widetilde{F}}{\partial \widetilde{y}} 
    \frac{\partial \widetilde{y}}{\partial z'}  + \frac{\partial
    \widetilde{F}}{\partial \widetilde{z}} 
    \frac{\partial \widetilde{z}}{\partial z'} \right) \! \! \Bigg|_{O}  =
    (2 + N) \frac{\partial \widetilde{x}}{\partial z'}(O) - \frac{\partial
    \widetilde{z}}{\partial z'} (O) = (2 + N) c_{13} - c_{33}
    .\end{align*}
    Итак, мы получаем следующие условия на матрицу \(C = (c_{ij})\): 
    \begin{align*}
        (2 + N) c_{11} - c_{31} &= 0 \\
        (2 + N) c_{12} - c_{32} &= 0 \\
        (2 + N) c_{13} - c_{33} &\ne  0 \\
        c_{12} = c_{32} &= 0 \\
        c_{22} &= 1
    .\end{align*}
    Итого, получаем, что в качестве искомой матрицы можно взять следующую:
    \[
    \begin{pmatrix}
        1 & 0 & 1 \\
        1 & 1 &  1\\
        2 + N & 0  & N + 1 \\
    \end{pmatrix}
    .\] 
    А тогда наше преобразование будет иметь вид:
    \[
    \lambda \begin{pmatrix}
        x' \\
        y' \\
        z' \\
    \end{pmatrix} = 
    \begin{pmatrix}
        -N - 1 & 0 & 1 \\
        -1 & 1 & 0 \\
        N + 2 & 0 & -1 \\
        % N + 3 & 0 & -1 \\
        % -1 & 1 & 0 \\
        % -N - 2 & 0 & 1 \\ 
    \end{pmatrix}
    \begin{pmatrix}
        \widetilde{x} \\
        \widetilde{y} \\
        \widetilde{z} \\
    \end{pmatrix} .\] 
    
    \item Шаг 3. После второго преобразования, наше уравнение приняло вид:
    \begin{align*}
        F'(x', y', z') &= \left(2 N^2 + 11 N + 15\right) \left( x' \right)^3
        + \left(5 N^2 + 24 N + 28\right) \left( x' \right)^2 z' \\ &+ \left(4 N^2
        + 17 N + 18\right) x' \left( z' \right)^2 + \left(N^2 + 4 N +
        4\right) \left( z' \right)^3  + x' y' z' + \left( y' \right)^2 z' + y'
        \left( z' \right)^2 
    .\end{align*}
    Поэтому условие \(F'(x', y', z') = 0\) можно переписать как 
    \begin{align*}
       -\left( y' \right)^2 z' - x' y' z' - y'
        \left( z' \right)^2 &= \left(2 N^2 + 11 N + 15\right) \left( x' \right)^3
        + \left(5 N^2 + 24 N + 28\right) \left( x' \right)^2 z' \\ &+ \left(4 N^2
        + 17 N + 18\right) x' \left( z' \right)^2 + \left(N^2 + 4 N +
        4\right) \left( z' \right)^3
    .\end{align*}
    Выделяем полный квадрат по \(y'\):
    \begin{align*}
       -\left( y' + \frac{1}{2}(x' + z')  \right)^2 z' + \frac{1}{2} (x' +
       z')^2 z' &= \left(2 N^2 + 11 N + 15\right) \left( x' \right)^3
        + \left(5 N^2 + 24 N + 28\right) \left( x' \right)^2 z' \\ &+ \left(4 N^2
        + 17 N + 18\right) x' \left( z' \right)^2 + \left(N^2 + 4 N +
        4\right) \left( z' \right)^3
    .\end{align*}
    Переносим свободные члены от \(y'\) в правую часть:
    \begin{align*}
       -\left( y' + \frac{1}{2}(x' + z')  \right)^2 z' &= \left(2 N^2 + 11 N + 15\right) \left( x' \right)^3
        + \left(5 N^2 + 24 N + 28 - \frac{1}{4} \right) \left( x' \right)^2 z' \\ &+ \left(4 N^2
        + 17 N + 18 - \frac{1}{2} \right) x' \left( z' \right)^2 + \left(N^2 + 4 N +
        4 - \frac{1}{4} \right) \left( z' \right)^3
    .\end{align*}
    Как известно, многочлен \(a x^3 + b x^2 + c x + d\) линейной заменой \(x
    \mapsto x - \frac{b}{3 a}\)
    приводится к виду \(p x^3 + q x + s\). В нашем
    случае замена будет такой:
    \[
    x'' = x' + \frac{5 N^2 + 24 N + 28 - \frac{1}{4}}{3(2 N^2 + 11 N + 15)}
    z'
    .\] 
    После подстановки получим:
    \begin{align*}
        -\left( y' + \frac{1}{2}(x' + z')  \right)^2 z' &= \left(2 N^2 + 11 N
        + 15\right) \left( x'' \right)^3 + A x'' \left( z' \right)^2 + B
        \left( z' \right)^3        
    ,\end{align*}
    где
    \begin{align*}
        &&\begin{split}
            A =   
            - \frac{N^4}{3 (N + 3) (2 N + 5)} - \frac{2
            N^3}{(N + 3) (2 N + 5)} - \frac{5 N^2}{2 (N + 3) (2 N + 5)} + \\
            \frac{7 N}{2 (N + 3) (2 N + 5)} + \frac{93}{16 (N + 3) (2 N +
            5)} 
        \end{split} \\ \\
        &&\begin{split}
            B =   - \frac{2 N^6}{27 (N + 3)^2 (2 N + 5)^2} -
            \frac{2 N^5}{3 (N + 3)^2 (2 N + 5)^2} - \frac{11 N^4}{6 (N + 3)^2 (2
            N + 5)^2} \\ - \frac{N^3}{3 (N + 3)^2 (2 N + 5)^2} + \frac{43 N^2}{8 (N
            + 3)^2 (2 N + 5)^2} \\ + \frac{41 N}{8 (N + 3)^2 (2 N + 5)^2} -
            \frac{47}{32 (N + 3)^2 (2 N + 5)^2}
        \end{split}
    .\end{align*}

    Деля на \(2 N^2 + 11 N + 15\), получаем
    \[
    -\left( y'' \right)^2 z' = (x'')^3 + a x'' \left( z'' \right)^2 + b \left(
    z'' \right)^3
    ,\] 
    где
    \begin{align*}
        y'' &=  y' + \frac{1}{2}(x' + z') \\
        z'' &= \frac{z'}{2 N^2 + 11 N + 15} \\
        a &= A \left( 2 N^2 + 11 N + 15 \right)\\
        b &= B \left( 2 N^2 + 11 N + 15 \right)^2
    .\end{align*}
    Заметим, что все \(N\)-ки в знаменателях сократятся и в итоге у нас
    получится:
    \begin{align*}
        -\left( y'' \right)^2 z' &= \left( x'' \right)^3  +  \frac{1}{48}
        \left(-16 N^4 - 96 N^3 - 120 N^2 + 168 N + 279\right) x'' \left( z''
        \right)^2 \\ 
        &+ \frac{1}{864} \left(-64 N^6 - 576 N^5 - 1584 N^4 - 288 N^3
        + 4644 N^2 + 4428 N - 1269\right) \left( z'' \right)^3
    .\end{align*}

    Окончательно, делая замены \(x''' = \frac{1}{6} x'', z''' =
    -\frac{1}{6^3} z''\), получаем:
    \begin{multline*}
        \left( y'' \right)^2 z''' = \left( x''' \right)^3  +  \left(-432 N^4
        - 2592 N^3 - 3240 N^2 + 4536 N + 7533\right) x''' \left( z'''
        \right)^2 \\ 
        +  \left(3456 N^6 + 31104 N^5 + 85536 N^4 + 15552 N^3 -
        250776 N^2 - 239112 N + 68526 \right) \left( z''' \right)^3
    .\end{multline*}

    Преобразования в шаге 3:
    \[
    \lambda \begin{pmatrix}
        x'' \\
        y'' \\
        z'' \\
    \end{pmatrix} = 
    \begin{pmatrix}
        1 & 0 & \frac{20 N^2 + 96 N + 111}{180 + 132 N + 24 N^2} \\
        \frac{1}{2} & 1 & \frac{1}{2} \\
        0 & 0 & \frac{1}{2 N^2 + 11 N + 15} \\
    \end{pmatrix}
    \begin{pmatrix}
        x' \\
        y' \\
        z' \\
    \end{pmatrix}
    .\] 
    И
    \[
    \lambda \begin{pmatrix}
        x''' \\
        y''' \\
        z''' \\
    \end{pmatrix} = 
    \begin{pmatrix}
        \frac{1}{6} & 0 & 0 \\
        0 & 1 & 0 \\
        0 & 0 & -\frac{1}{216} \\
    \end{pmatrix}
    \begin{pmatrix}
        x'' \\
        y'' \\
        z'' \\
    \end{pmatrix}
    .\] 
\end{itemize}

Итого, собирая все преобразования вместе, получаем искомое проективное
преобразование:
\[
    \lambda \begin{pmatrix}
        x''' \\
        y''' \\
        z''' \\
    \end{pmatrix} = 
    \begin{pmatrix}
        \frac{1}{6} & 0 & 0 \\
        0 & 1 & 0 \\
        0 & 0 & -\frac{1}{216} \\
    \end{pmatrix}
    \begin{pmatrix}
        1 & 0 & \frac{20 N^2 + 96 N + 111}{180 + 132 N + 24 N^2} \\
        \frac{1}{2} & 1 & \frac{1}{2} \\
        0 & 0 & \frac{1}{2 N^2 + 11 N + 15} \\
    \end{pmatrix}
    \begin{pmatrix}
        -N - 1 & 0 & 1 \\
        -1 & 1 & 0 \\
        N + 2 & 0 & -1 \\
    \end{pmatrix}
    \begin{pmatrix}
        1 & 1 & 0 \\
        1 & 0 & 0 \\
        0 & 0 & 1 \\
    \end{pmatrix}
    \begin{pmatrix}
        x \\
        y \\
        z \\
    \end{pmatrix}
.\] 
То есть искомая матрица есть
\[
\begin{pmatrix}
    \frac{-4 N^3 - 20 N^2 - 9 N + 42}{72 (N + 3) (2 N + 5)} &
    \frac{-4 N^3 - 20 N^2 - 9 N + 42}{72 (N + 3) (2 N + 5)} &
    \frac{4 N^2 + 36 N + 69}{72 (N + 3) (2 N + 5)} \\
    \frac{1}{2} &  -\frac{1}{2} & 0 \\
    \frac{-N - 2}{216 (N + 3) (2 N + 5)} & \frac{-N - 2}{216
    (N + 3) (2 N + 5)} & \frac{1}{216 (N + 3) (2 N + 5)} \\
\end{pmatrix}
.\] 
Так как матрица проективного преобразования определена с точностью до
умножения на скаляр, то умножая всю матрицу на \(216 (3 + N) (5 + 2 N)\),
имеем:
\[
\begin{pmatrix}
    -12 N^3 - 60 N^2 - 27 N + 126 &  -12 N^3 - 60 N^2 - 27 N + 126 &
    12 N^2 + 108 N + 207 \\
    216 N^2 + 1188 N + 1620 &  -216 N^2 - 1188 N - 1620 & 0 \\
    -N - 2 &  -N - 2 & 1 \\
\end{pmatrix}
.\] 

\bigskip
\bigskip

\noindent Подытожим: исходная кубика, заданная уравнением
\[
x^3 + y^3 + z^3 + (1 - N) (x^2 y + x^2 z + y^2 x + y^2 z + z^2 x + z^2 y) +
(3 - 2 N) x y z = 0
\] 
приводится к кубике, заданной уравнением
\begin{multline*}
    \left( y'' \right)^2 z''' = \left( x''' \right)^3  +  \left(-432 N^4
    - 2592 N^3 - 3240 N^2 + 4536 N + 7533\right) x''' \left( z'''
    \right)^2 \\ 
    +  \left(3456 N^6 + 31104 N^5 + 85536 N^4 + 15552 N^3 -
    250776 N^2 - 239112 N + 68526 \right) \left( z''' \right)^3 = 0
\end{multline*}
проективным преобразованием с матрицей:
\[
\begin{pmatrix}
    -12 N^3 - 60 N^2 - 27 N + 126 &  -12 N^3 - 60 N^2 - 27 N + 126 &
    12 N^2 + 108 N + 207 \\
    216 N^2 + 1188 N + 1620 &  -216 N^2 - 1188 N - 1620 & 0 \\
    -N - 2 &  -N - 2 & 1 \\
\end{pmatrix}
.\] 


