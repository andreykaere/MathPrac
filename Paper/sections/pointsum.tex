\section*{Поиск рациональных точек}

%!TEX root = ../paper.tex

Итак, нам дана кубика в форме Вейерштрасса, наша задача понять, как устроены
рациональные точки на ней. Для этого удобно ввести дополнительную структуру на
множестве рациональных точек. Определим сложение точек.  Суммой \(P\) и \(Q\)
назовём третью точку пересечения прямой проходящей через \(P\) и \(Q\) с
кубикой. Понятно, что если исходные точки был рациональны, то \(P + Q\), тоже
будет рациональной.  Оказывается, что множество рациональных точек, на кубике
в форме Вейерштрасса образуют абелеву группу, для данной операции сложения.
Более того, даже для произвольной кубики что-то можно сказать про устройство
этой группы. Имеет место следующая теорема:

\begin{theoremf}
    На эллиптической кривой \(E\), заданной уравнением с рациональными
    коэффициентами, группа \(E(\QQ)\) рациональных точек является
    конечно порождённой абелевой группой.
\end{theoremf}

В нашем случае известно (см. например ~\cite{unus_rep_prob}) устройство этой группы:
\(\ZZ \oplus \ZZ_6\). Это позволяет нам конструктивно описать много
рациональных точек, ибо есть явные формулы для сложения точек на кубике в форме
Вейерштрасса, приведём их. Пусть \(P = (x_{p}, y_{p}), Q = (x_{q}, y_{q}), R =
(x_{r}, y_{r})\), где \(R = P + Q\). Тогда мы имеем:
\[
\begin{aligned}
    x_r &= m^2 - x_p - x_q \\
    y_r &= y_p + m(x_r - x_p) \\
\end{aligned} \qquad (*)
,\] 
где \(m = (y_{p} - y_{q}) / (x{p} - x{q})\).


\begin{remark}
    Эти формулы справедливы для различных \(P\) и \(Q\), однако несложно получить и
    для случая \(P = Q\).
\end{remark}

\begin{remark}
    Эти формулы работают только в аффинной карте \(z = 1\), однако это не
    ограничивает общность, т.к. единственная точка кубики вне этой карты это
    \((0 : 1 : 0)\), которая является единичным элементом в группе рациональных точек. 
\end{remark}

Теперь мы можем описать алгоритм. Программа получает на вход произвольную
\((*)\) кубику и приводит её к форме Вейерштрасса, и заодно находит прямое и
обратное преобразование. После этого на кривой ищется произвольная
рациональная точка, которая не является точкой кручения, то есть  рациональная
\(P\), такая что, среди \(P, 2P, 3P, 4P, 5P, 6P\) нет единичного элемента.
Функция \textsf{FindRational} получает коэффициенты \(a, b\) и радиус в
котором следует искать рациональную точку,  а выдаёт её координаты. Точки вида
\(nP\) находятся в функции \textsf{ScMult}, которая складывает точку \(P\) с
собой \(n\) раз с помощью \textsf{PoinSum} - функции складывающей произвольные
две точки на кубике с помощью формул  \((*)\) (в аффинной карте \(z = 1\)). 

\begin{remark*}
    Поиск рациональной точкой перебором является самой вычислительное
    сложной частью алгоритма, например, для некоторых коэффициентов \(a, b\) кубики в
    форме \(y^2 = x^3 + ax + b\) рациональная точка не находится за разумное
    время, хоть и известно, что она существует 
\end{remark*}

После этого программа находит точки \(P, 2P, ... , nP\), с помощью функции
\textsf{GenerateNpoints}. Затем находит координаты каждой из них в начальной системе
координат посредством Reverse. Чтобы точка соответствовала натуральному
решению исходного уравнения, все координаты должны быть одного знака. После
чего домножая их на общий знаменатель получаем решение исходной задачи. Это
выполняется в функции \textsf{RevNFind}. Таким образом, вызывая данную функцию от
коэффициентов кубики, найденной рациональной точки и  количества точек,
которое мы хотим перебрать -- \(n\), получаем натуральные решения исходного
уравнения. Например, в случае \(N = 4\), достаточно взять \(n = 9\), т.е.
точка \(9P\) будет соответствовать натуральному решению.
 
Заметим только, что размер полученного решения зависит от выбора точки \(P\),
неудачный выбор может привести к тому, что количество цифр в ответе станет
400, вместо 80.
